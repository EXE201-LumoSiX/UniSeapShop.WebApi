services:
  
  uniseapshop.webapi:
    image: phuctran362003/uniseapshopwebapi:latest
    build:
      context: .
      dockerfile: UniSeapShop.API/Dockerfile
    depends_on:
      redis:
        condition: service_healthy
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ConnectionStrings__DefaultConnection=Server=103.211.201.141,1433;Database=UniSeapShopDB;User Id=sa;Password=YourStrong!Passw0rd;TrustServerCertificate=True
      - JWT__SecretKey=UniSeapShop_SECRETKEY_SIEUCAPBAOMAT_VAYMACHUADU16KYTU
      - JWT__Issuer=UniSeapShop_Issuer
      - JWT__Audience=UniSeapShop_Audience
      - RESEND_APITOKEN=re_gQNBXJvY_ANFdgQphKQBxdW5DNf2UG6Zk
      - RESEND_FROM=noreply@fpt-devteam.fun
      - "Payment__PayOS__ClientId=c45d1aed-9fdb-46f5-aea2-dad5107b5abd"
      - "Payment__PayOS__ApiKey=d1809534-a218-42a7-a4d9-922e474a0b38"
      - "Payment__PayOS__ChecksumKey=9a291b87a0921d424054082fc4174eb79dbc80926dc03080266f65592b12f382"
    ports:
      - "5000:5000"

  redis:
    image: redis:6.2
    restart: always
    ports:
      - "6379:6379"
    volumes:
      - redisdata:/data
    healthcheck:
      test: [ "CMD", "redis-cli", "ping" ]
      interval: 5s
      timeout: 3s
      retries: 5


volumes:
  redisdata:
